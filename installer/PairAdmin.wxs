<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <!-- Main Executable -->
      <Component Guid="11111111-1111-1111-1111-111111111111">
        <File Source="$(var.SourceDir)\PairAdmin.exe"
              KeyPath="yes"
              Checksum="yes" />
      </Component>
      
      <!-- Runtime Dependencies -->
      <Component Guid="22222222-2222-2222-2222-222222222222">
        <File Source="$(var.SourceDir)\PairAdmin.dll" />
        <File Source="$(var.SourceDir)\PairAdmin*.dll" />
      </Component>
      
      <!-- Configuration Files -->
      <Component Guid="33333333-3333-3333-3333-333333333333">
        <File Source="$(var.SourceDir)\appsettings.json" />
        <File Source="$(var.SourceDir)\*.json" />
      </Component>
      
      <!-- UI Resources -->
      <Component Guid="44444444-4444-4444-4444-444444444444">
        <File Source="$(var.SourceDir)\*.xaml" />
        <File Source="$(var.SourceDir)\*.baml" />
      </Component>
      
      <!-- Assets -->
      <Component Guid="55555555-5555-5555-5555-555555555555">
        <File Source="$(var.SourceDir)\Assets\*" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="DocumentationComponents" Directory="INSTALLFOLDER">
      <Component Guid="66666666-6666-6666-6666-666666666666">
        <DirectoryCreate />
        <File Source="..\docs\*.md" DestinationDirectory="docs" />
      </Component>
    </ComponentGroup>

    <!-- Desktop Shortcut -->
    <DirectoryRef Id="DesktopFolder">
      <Component Id="ApplicationShortcutDesktop" Guid="77777777-7777-7777-7777-777777777777">
        <Shortcut Id="DesktopShortcut"
                  Name="PairAdmin"
                  Description="AI-Assisted Terminal Administration for PuTTY"
                  Target="[INSTALLFOLDER]PairAdmin.exe"
                  WorkingDirectory="INSTALLFOLDER" />
        <RemoveFolder Id="DesktopShortcutRemove" Directory="DesktopFolder" On="uninstall" />
        <RegistryValue Root="HKCU" 
                       Key="Software\PairAdmin" 
                       Name="DesktopShortcut" 
                       Type="string" 
                       Value="installed" 
                       KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <!-- Start Menu Shortcuts -->
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcutStartMenu" Guid="88888888-8888-8888-8888-888888888888">
        <Shortcut Id="StartMenuShortcut"
                  Name="PairAdmin"
                  Description="AI-Assisted Terminal Administration for PuTTY"
                  Target="[INSTALLFOLDER]PairAdmin.exe"
                  WorkingDirectory="INSTALLFOLDER" />
        <Shortcut Id="StartMenuDocShortcut"
                  Name="PairAdmin Help"
                  Description="Open PairAdmin documentation"
                  Target="[INSTALLFOLDER]docs\README.md"
                  WorkingDirectory="INSTALLFOLDER" />
        <RemoveFolder Id="StartMenuRemove" Directory="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU" 
                       Key="Software\PairAdmin" 
                       Name="StartMenuShortcut" 
                       Type="string" 
                       Value="installed" 
                       KeyPath="yes" />
      </Component>

      <!-- Uninstall Shortcut -->
      <Component Id="ApplicationUninstallShortcut" Guid="99999999-9999-9999-9999-999999999999">
        <Shortcut Id="UninstallShortcut"
                  Name="Uninstall PairAdmin"
                  Description="Remove PairAdmin from your computer"
                  Target="[System64Folder]msiexec.exe"
                  Arguments="/x [ProductCode]" />
      </Component>
    </DirectoryRef>

    <!-- AppData for Settings -->
    <DirectoryRef Id="PairAdminAppData">
      <Component Guid="AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA">
        <CreateFolder />
        <Environment Id="PAIRADMIN_APPDATA" 
                     Name="PAIRADMIN_APPDATA" 
                     Value="[PairAdminAppData]" 
                     Permanent="yes" 
                     Part="all" 
                     Action="set" />
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
